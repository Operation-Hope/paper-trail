CREATE TABLE Politicians (
    PoliticianID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FirstName TEXT,
    LastName TEXT NOT NULL,
    Party TEXT,
    Chamber TEXT,
    -- Can be NULL for Governors/Presidents
    State TEXT NOT NULL,
    District INT,
    IsActive BOOLEAN DEFAULT false,
    Role TEXT -- 'Senator', 'Representative', 'Governor', 'President'
);

ALTER TABLE
    Politicians
ADD
    CONSTRAINT unique_politician_name_state UNIQUE (FirstName, LastName, State);

CREATE TABLE Bills (
    BillID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    BillNumber TEXT NOT NULL UNIQUE,
    Title TEXT,
    DateIntroduced DATE,
    Congress INT,
    Subjects TEXT [] -- For linking to donor interests
);

CREATE INDEX idx_bills_congress ON Bills (Congress);

CREATE TABLE Donors (
    DonorID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    Name TEXT NOT NULL,
    DonorType TEXT,
    -- 'Individual', 'Corporation', 'PAC', 'SuperPAC', 'Other', 'Unknown'
    Employer TEXT,
    Industry TEXT,
    City TEXT,
    State TEXT,
    UNIQUE (Name, DonorType, Employer, State)
);

CREATE TABLE Donations (
    DonationID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DonorID BIGINT REFERENCES Donors(DonorID),
    PoliticianID BIGINT REFERENCES Politicians(PoliticianID),
    Amount DECIMAL(12, 2) NOT NULL,
    Date DATE,
    ContributionType TEXT -- 'Individual', 'PAC/Party'
);

CREATE TABLE Votes (
    VoteID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PoliticianID BIGINT REFERENCES Politicians(PoliticianID),
    BillID BIGINT REFERENCES Bills(BillID),
    Vote TEXT NOT NULL
);

CREATE TABLE fec_politician_map (
    fec_candidate_id TEXT PRIMARY KEY,
    politician_id BIGINT REFERENCES Politicians(PoliticianID) NOT NULL
);

SELECT
    'Schema successfully rebuilt and ready for data.' AS Status;